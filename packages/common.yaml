safe_mode:

# Diagnostics / basics
button:
  - platform: restart
    name: "Restart"
    entity_category: config

  - platform: factory_reset
    name: "Factory Reset"
    id: Reset
    entity_category: config

  - platform: safe_mode
    name: "Safe Mode"
    internal: false
    entity_category: config

sensor:
  # Uptime (internal)
  - platform: uptime
    name: "Uptime"
    id: uptime_sensor
    entity_category: diagnostic
    internal: true

  # WiFi RSSI in dB
  - platform: wifi_signal
    name: "WiFi Signal dB"
    id: wifi_signal_db
    update_interval: 60s
    entity_category: diagnostic

  # WiFi percentage (same formula as BBP nodes)
  - platform: wifi_signal
    name: "WiFi Signal %"
    id: wifi_signal_percent
    update_interval: 60s
    entity_category: diagnostic
    unit_of_measurement: "%"
    accuracy_decimals: 0
    icon: mdi:wifi
    filters:
      - lambda: |-
          if (id(wifi_signal_db).state >= -50) return 100;
          if (id(wifi_signal_db).state <= -100) return 0;
          return (id(wifi_signal_db).state + 100) * 2;

  # Internal temperature
  - platform: internal_temperature
    name: "ESP32 Internal Temperature"
    update_interval: 120s
    entity_category: diagnostic

text_sensor:
  - platform: version
    name: "ESPHome Version"
    entity_category: diagnostic

  - platform: wifi_info
    ip_address:
      name: ESP IP Address
    ssid:
      name: ESP Connected SSID
    bssid:
      name: ESP Connected BSSID
    mac_address:
      name: ESP Mac Wifi Address
    dns_address:
      name: ESP DNS Address

binary_sensor:
  - platform: status
    name: "Node Status"
    id: system_status
    trigger_on_initial_state: true
